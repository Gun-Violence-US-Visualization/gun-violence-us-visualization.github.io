{"ast":null,"code":"var _jsxFileName = \"/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Correlation.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport * as d3 from \"d3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Correlation(data) {\n  _s();\n\n  const [statesData, setStatesData] = useState([]); //react用来注释数据\n\n  const ref = React.useRef(null); // console.log(data)\n\n  const [size, setSize] = useState({\n    width: document.documentElement.clientWidth,\n    hieght: document.documentElement.clientHeight\n  });\n  const onResize = useCallback(() => {\n    setSize({\n      width: document.documentElement.clientWidth,\n      height: document.documentElement.clientHeight\n    });\n  }, []);\n  useEffect(() => {\n    (async () => {\n      // set the dimensions and margins of the graph\n      const margin = {\n        top: 10,\n        right: 30,\n        bottom: 30,\n        left: 60\n      },\n            width = ref.current.clientWidth - 30,\n            height = 400 - margin.top - margin.bottom; // append the svg object to the body of the page\n\n      const svg = d3.select(\".usCorrelation\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n      const tooltip = d3.select(\".usCorrelation\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\"); //Read the data\n\n      d3.csv(\"./data/state.csv\").then(function (data) {\n        // Add X axis\n        const x = d3.scaleLinear().domain([0, 110]).range([0, width]);\n        svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(x)); // Add Y axis\n\n        const y = d3.scaleLinear().domain([0, 0.7]).range([height, 0]);\n        svg.append(\"g\").call(d3.axisLeft(y)); // Color scale: give me a specie name, I return a color\n\n        const color = d3.scaleLinear().domain([-25, 20]).range([\"red\", \"blue\"]); // Highlight the specie that is hovered\n\n        const highlight = function (event, d) {\n          const selected_specie = d.rate;\n          tooltip.style(\"opacity\", 1);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", \"lightgrey\").attr(\"r\", 3);\n          d3.selectAll(\"#\" + \"dot\" + d.state).transition().duration(200).style(\"fill\", color(selected_specie)).attr(\"r\", 5);\n        }; // Highlight the specie that is hovered\n\n\n        const doNotHighlight = function (event, d) {\n          tooltip.transition().duration(200).style(\"opacity\", 0);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", d => color(d.rate)).attr(\"r\", 3);\n        };\n\n        const mousemove = function (event, d) {\n          tooltip.html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`).style(\"left\", event.x / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n          .style(\"top\", event.y / 2 + \"px\");\n        };\n\n        svg.append('g').selectAll(\"dot\").data(data).enter().append(\"circle\").attr(\"class\", function (d) {\n          return \"dot \" + d.rate;\n        }).attr(\"id\", function (d) {\n          console.log(d.state);\n          return \"dot\" + d.state;\n        }).attr(\"cx\", function (d) {\n          return x(106 - d.policy);\n        }).attr(\"cy\", function (d) {\n          return y(d.gunhold);\n        }).attr(\"r\", 3).style(\"fill\", function (d) {\n          return color(d.rate);\n        }).on(\"mouseover\", highlight).on(\"mouseleave\", doNotHighlight).on(\"mousemove\", mousemove);\n        svg.append('g');\n      });\n    })();\n  }, [statesData.length]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"down-chart-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-title\",\n      children: \"RELATION between POLICY & VOTE\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart usCorrelation\",\n      ref: ref\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart-example\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"./media/party-relate.svg\",\n        width: \"95%\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 49\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 9\n  }, this) //渲染了这个东西出来\n  ;\n}\n\n_s(Correlation, \"a5Bd5WyibQXmYDRJszvXDFYos1A=\");\n\n_c = Correlation;\nexport default Correlation;\n\nvar _c;\n\n$RefreshReg$(_c, \"Correlation\");","map":{"version":3,"sources":["/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Correlation.js"],"names":["React","useState","useEffect","useCallback","d3","Correlation","data","statesData","setStatesData","ref","useRef","size","setSize","width","document","documentElement","clientWidth","hieght","clientHeight","onResize","height","margin","top","right","bottom","left","current","svg","select","append","attr","tooltip","style","csv","then","x","scaleLinear","domain","range","call","axisBottom","y","axisLeft","color","highlight","event","d","selected_specie","rate","selectAll","transition","duration","state","doNotHighlight","mousemove","html","gunhold","policy","enter","console","log","on","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\"\r\nimport * as d3 from \"d3\"\r\n\r\nfunction Correlation(data) {\r\n    const [statesData, setStatesData] = useState([]);     //react用来注释数据\r\n    const ref = React.useRef(null)\r\n    // console.log(data)\r\n    const [size, setSize] = useState({\r\n        width: document.documentElement.clientWidth,\r\n        hieght: document.documentElement.clientHeight\r\n      })\r\n    \r\n      const onResize = useCallback(() => {\r\n        setSize({\r\n          width: document.documentElement.clientWidth,\r\n          height: document.documentElement.clientHeight,\r\n        })\r\n      }, [])\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            // set the dimensions and margins of the graph\r\n            const margin = { top: 10, right: 30, bottom: 30, left: 60 },\r\n                width = ref.current.clientWidth-30,\r\n                height = 400 - margin.top - margin.bottom;\r\n\r\n            // append the svg object to the body of the page\r\n            const svg = d3.select(\".usCorrelation\")\r\n                .append(\"svg\")\r\n                .attr(\"width\", width + margin.left + margin.right)\r\n                .attr(\"height\", height + margin.top + margin.bottom)\r\n                .append(\"g\")\r\n                .attr(\"transform\",\r\n                    `translate(${margin.left}, ${margin.top})`);\r\n\r\n            const tooltip = d3.select(\".usCorrelation\")\r\n                .append(\"div\")\r\n                .style(\"opacity\", 0)\r\n                .attr(\"class\", \"tooltip\")\r\n                .style(\"background-color\", \"white\")\r\n                .style(\"border\", \"solid\")\r\n                .style(\"border-width\", \"1px\")\r\n                .style(\"border-radius\", \"5px\")\r\n                .style(\"padding\", \"10px\")\r\n\r\n            //Read the data\r\n            d3.csv(\"./data/state.csv\").then(function (data) {\r\n                // Add X axis\r\n                const x = d3.scaleLinear()\r\n                    .domain([0, 110])\r\n                    .range([0, width]);\r\n                svg.append(\"g\")\r\n                    .attr(\"transform\", `translate(0, ${height})`)\r\n                    .call(d3.axisBottom(x));\r\n\r\n                // Add Y axis\r\n                const y = d3.scaleLinear()\r\n                    .domain([0, 0.7])\r\n                    .range([height, 0]);\r\n                svg.append(\"g\")\r\n                    .call(d3.axisLeft(y));\r\n\r\n                // Color scale: give me a specie name, I return a color\r\n                const color = d3.scaleLinear().domain([-25, 20])\r\n                    .range([\"red\", \"blue\"])\r\n\r\n                // Highlight the specie that is hovered\r\n                const highlight = function (event, d) {\r\n                    const selected_specie = d.rate\r\n\r\n                    tooltip\r\n                        .style(\"opacity\", 1)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", \"lightgrey\")\r\n                        .attr(\"r\", 3)\r\n\r\n                    d3.selectAll(\"#\" + \"dot\" + d.state)\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", color(selected_specie))\r\n                        .attr(\"r\", 5)\r\n                }\r\n\r\n                // Highlight the specie that is hovered\r\n                const doNotHighlight = function (event, d) {\r\n                    tooltip\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"opacity\", 0)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", d => color(d.rate))\r\n                        .attr(\"r\", 3)\r\n                }\r\n                const mousemove = function (event, d) {\r\n                    tooltip\r\n                        .html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`)\r\n                        .style(\"left\", (event.x) / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\r\n                        .style(\"top\", (event.y) / 2 + \"px\")\r\n                }\r\n                svg.append('g')\r\n                    .selectAll(\"dot\")\r\n                    .data(data)\r\n                    .enter()\r\n                    .append(\"circle\")\r\n                    .attr(\"class\", function (d) { return \"dot \" + d.rate })\r\n                    .attr(\"id\", function (d) { console.log(d.state); return \"dot\" + d.state })\r\n                    .attr(\"cx\", function (d) { return x(106 - d.policy); })\r\n                    .attr(\"cy\", function (d) { return y(d.gunhold); })\r\n                    .attr(\"r\", 3)\r\n                    .style(\"fill\", function (d) { return color(d.rate); })\r\n                    .on(\"mouseover\", highlight)\r\n                    .on(\"mouseleave\", doNotHighlight)\r\n                    .on(\"mousemove\", mousemove)\r\n                svg.append('g')\r\n            })\r\n        })();\r\n    }, [statesData.length]\r\n    )\r\n\r\n    return (\r\n        <div className=\"down-chart-container\">\r\n            <div className=\"chart-title\">{\"RELATION between POLICY & VOTE\"}</div>\r\n            <div className=\"down-chart usCorrelation\" ref={ref}></div>\r\n            <div className=\"down-chart-example\"><img src=\"./media/party-relate.svg\" width=\"95%\"/> </div>\r\n        </div>   //渲染了这个东西出来\r\n    )\r\n}\r\n\r\nexport default Correlation"]},"metadata":{},"sourceType":"module"}