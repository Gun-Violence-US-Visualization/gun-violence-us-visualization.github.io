{"ast":null,"code":"var _jsxFileName = \"/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Correlation.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport * as d3 from \"d3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Correlation(data) {\n  _s();\n\n  const [statesData, setStatesData] = useState([]); //react用来注释数据\n\n  const ref = React.useRef(null); // console.log(data)\n\n  const [size, setSize] = useState({\n    width: document.documentElement.clientWidth,\n    hieght: document.documentElement.clientHeight\n  });\n  const onResize = useCallback(() => {\n    setSize({\n      width: document.documentElement.clientWidth,\n      height: document.documentElement.clientHeight\n    });\n  }, []);\n  useEffect(() => {\n    (async () => {\n      window.addEventListener('resize', onResize); // set the dimensions and margins of the graph\n\n      const margin = {\n        top: 10,\n        right: 30,\n        bottom: 30,\n        left: 60\n      },\n            width = ref.current.clientWidth - 30,\n            height = 400 - margin.top - margin.bottom;\n      const svgEL = d3.select(ref.current);\n      svgEL.selectAll(\"*\").remove(); // append the svg object to the body of the page\n\n      const svg = svgEL.append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n      const tooltip = d3.select(\".usCorrelation\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\"); //Read the data\n\n      d3.csv(\"./data/state.csv\").then(function (data) {\n        // Add X axis\n        const x = d3.scaleLinear().domain([0, 110]).range([0, width]);\n        svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(x)); // Add Y axis\n\n        const y = d3.scaleLinear().domain([0, 0.7]).range([height, 0]);\n        svg.append(\"g\").call(d3.axisLeft(y)); // Color scale: give me a specie name, I return a color\n\n        const color = d3.scaleLinear().domain([-25, 20]).range([\"red\", \"blue\"]); // Highlight the specie that is hovered\n\n        const highlight = function (event, d) {\n          const selected_specie = d.rate;\n          tooltip.style(\"opacity\", 1);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", \"lightgrey\").attr(\"r\", 3);\n          d3.selectAll(\"#\" + \"dot\" + d.state).transition().duration(200).style(\"fill\", color(selected_specie)).attr(\"r\", 5);\n        }; // Highlight the specie that is hovered\n\n\n        const doNotHighlight = function (event, d) {\n          tooltip.transition().duration(200).style(\"opacity\", 0);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", d => color(d.rate)).attr(\"r\", 3);\n        };\n\n        const mousemove = function (event, d) {\n          tooltip.html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`).style(\"left\", event.x / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n          .style(\"top\", event.y / 2 + \"px\");\n        };\n\n        svg.append('g').selectAll(\"dot\").data(data).enter().append(\"circle\").attr(\"class\", function (d) {\n          return \"dot \" + d.rate;\n        }).attr(\"id\", function (d) {\n          console.log(d.state);\n          return \"dot\" + d.state;\n        }).attr(\"cx\", function (d) {\n          return x(106 - d.policy);\n        }).attr(\"cy\", function (d) {\n          return y(d.gunhold);\n        }).attr(\"r\", 3).style(\"fill\", function (d) {\n          return color(d.rate);\n        }).on(\"mouseover\", highlight).on(\"mouseleave\", doNotHighlight).on(\"mousemove\", mousemove);\n        svg.append('g');\n      });\n      return () => {\n        window.removeEventListener('resize', onResize);\n      };\n    })();\n  }, [statesData.length, size]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"down-chart-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-title\",\n      children: \"RELATION between POLICY & VOTE\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart usCorrelation\",\n      ref: ref\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart-example\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"./media/party-relate.svg\",\n        width: \"95%\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 49\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 9\n  }, this) //渲染了这个东西出来\n  ;\n}\n\n_s(Correlation, \"a5Bd5WyibQXmYDRJszvXDFYos1A=\");\n\n_c = Correlation;\nexport default Correlation;\n\nvar _c;\n\n$RefreshReg$(_c, \"Correlation\");","map":{"version":3,"sources":["/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Correlation.js"],"names":["React","useState","useEffect","useCallback","d3","Correlation","data","statesData","setStatesData","ref","useRef","size","setSize","width","document","documentElement","clientWidth","hieght","clientHeight","onResize","height","window","addEventListener","margin","top","right","bottom","left","current","svgEL","select","selectAll","remove","svg","append","attr","tooltip","style","csv","then","x","scaleLinear","domain","range","call","axisBottom","y","axisLeft","color","highlight","event","d","selected_specie","rate","transition","duration","state","doNotHighlight","mousemove","html","gunhold","policy","enter","console","log","on","removeEventListener","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\"\r\nimport * as d3 from \"d3\"\r\n\r\nfunction Correlation(data) {\r\n    const [statesData, setStatesData] = useState([]);     //react用来注释数据\r\n    const ref = React.useRef(null)\r\n    // console.log(data)\r\n    const [size, setSize] = useState({\r\n        width: document.documentElement.clientWidth,\r\n        hieght: document.documentElement.clientHeight\r\n      })\r\n    \r\n      const onResize = useCallback(() => {\r\n        setSize({\r\n          width: document.documentElement.clientWidth,\r\n          height: document.documentElement.clientHeight,\r\n        })\r\n      }, [])\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n\r\n            window.addEventListener('resize', onResize);\r\n            // set the dimensions and margins of the graph\r\n            const margin = { top: 10, right: 30, bottom: 30, left: 60 },\r\n                width = ref.current.clientWidth-30,\r\n                height = 400 - margin.top - margin.bottom;\r\n      const svgEL = d3.select(ref.current);\r\n      svgEL.selectAll(\"*\").remove();\r\n\r\n            // append the svg object to the body of the page\r\n            const svg = svgEL\r\n                .append(\"svg\")\r\n                .attr(\"width\", width + margin.left + margin.right)\r\n                .attr(\"height\", height + margin.top + margin.bottom)\r\n                .append(\"g\")\r\n                .attr(\"transform\",\r\n                    `translate(${margin.left}, ${margin.top})`);\r\n\r\n            const tooltip = d3.select(\".usCorrelation\")\r\n                .append(\"div\")\r\n                .style(\"opacity\", 0)\r\n                .attr(\"class\", \"tooltip\")\r\n                .style(\"background-color\", \"white\")\r\n                .style(\"border\", \"solid\")\r\n                .style(\"border-width\", \"1px\")\r\n                .style(\"border-radius\", \"5px\")\r\n                .style(\"padding\", \"10px\")\r\n\r\n            //Read the data\r\n            d3.csv(\"./data/state.csv\").then(function (data) {\r\n                // Add X axis\r\n                const x = d3.scaleLinear()\r\n                    .domain([0, 110])\r\n                    .range([0, width]);\r\n                svg.append(\"g\")\r\n                    .attr(\"transform\", `translate(0, ${height})`)\r\n                    .call(d3.axisBottom(x));\r\n\r\n                // Add Y axis\r\n                const y = d3.scaleLinear()\r\n                    .domain([0, 0.7])\r\n                    .range([height, 0]);\r\n                svg.append(\"g\")\r\n                    .call(d3.axisLeft(y));\r\n\r\n                // Color scale: give me a specie name, I return a color\r\n                const color = d3.scaleLinear().domain([-25, 20])\r\n                    .range([\"red\", \"blue\"])\r\n\r\n                // Highlight the specie that is hovered\r\n                const highlight = function (event, d) {\r\n                    const selected_specie = d.rate\r\n\r\n                    tooltip\r\n                        .style(\"opacity\", 1)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", \"lightgrey\")\r\n                        .attr(\"r\", 3)\r\n\r\n                    d3.selectAll(\"#\" + \"dot\" + d.state)\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", color(selected_specie))\r\n                        .attr(\"r\", 5)\r\n                }\r\n\r\n                // Highlight the specie that is hovered\r\n                const doNotHighlight = function (event, d) {\r\n                    tooltip\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"opacity\", 0)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", d => color(d.rate))\r\n                        .attr(\"r\", 3)\r\n                }\r\n                const mousemove = function (event, d) {\r\n                    tooltip\r\n                        .html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`)\r\n                        .style(\"left\", (event.x) / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\r\n                        .style(\"top\", (event.y) / 2 + \"px\")\r\n                }\r\n                svg.append('g')\r\n                    .selectAll(\"dot\")\r\n                    .data(data)\r\n                    .enter()\r\n                    .append(\"circle\")\r\n                    .attr(\"class\", function (d) { return \"dot \" + d.rate })\r\n                    .attr(\"id\", function (d) { console.log(d.state); return \"dot\" + d.state })\r\n                    .attr(\"cx\", function (d) { return x(106 - d.policy); })\r\n                    .attr(\"cy\", function (d) { return y(d.gunhold); })\r\n                    .attr(\"r\", 3)\r\n                    .style(\"fill\", function (d) { return color(d.rate); })\r\n                    .on(\"mouseover\", highlight)\r\n                    .on(\"mouseleave\", doNotHighlight)\r\n                    .on(\"mousemove\", mousemove)\r\n                svg.append('g')\r\n\r\n            })\r\n\r\n            return (() => {\r\n                window.removeEventListener('resize', onResize)\r\n              })\r\n        })();\r\n    }, [statesData.length, size]\r\n    )\r\n\r\n    return (\r\n        <div className=\"down-chart-container\">\r\n            <div className=\"chart-title\">{\"RELATION between POLICY & VOTE\"}</div>\r\n            <div className=\"down-chart usCorrelation\" ref={ref}></div>\r\n            <div className=\"down-chart-example\"><img src=\"./media/party-relate.svg\" width=\"95%\"/> </div>\r\n        </div>   //渲染了这个东西出来\r\n    )\r\n}\r\n\r\nexport default Correlation"]},"metadata":{},"sourceType":"module"}