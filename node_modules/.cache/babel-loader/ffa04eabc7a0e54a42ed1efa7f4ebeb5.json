{"ast":null,"code":"var _jsxFileName = \"/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Profile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport * as d3 from \"d3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Profile(data) {\n  _s();\n\n  // const ref = React.useRef();\n  const [statesData, setStatesData] = useState([]); //react用来注释数据\n\n  const ref = React.useRef(null); // console.log(data)\n\n  useEffect(() => {\n    (async () => {\n      // set the dimensions and margins of the graph\n      const formatter = d3.format(\".0%\");\n      const margin = {\n        top: 10,\n        right: 30,\n        bottom: 30,\n        left: 60\n      },\n            width = ref.current.clientWidth - 30,\n            height = 400 - margin.top - margin.bottom; // append the svg object to the body of the page\n\n      const svg = d3.select(\".usProfile\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n      const tooltip = d3.select(\".usProfile\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\"); //Read the data\n\n      d3.csv(\"./data/profile.csv\").then(function (data) {\n        // Add X axis\n        const x = d3.scaleLinear().domain([10, 70]).range([0, width]);\n        svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(x)); // Add Y axis\n\n        const y = d3.scaleLinear().domain([0, 110]).range([height, 0]);\n        svg.append(\"g\").call(d3.axisLeft(y)); // Color scale: give me a specie name, I return a color\n\n        const color = d3.scaleOrdinal().domain([\"Black_Male\", \"Asian_Male\", \"White_Male\", \"Unknown_Male\", \"Unknown\", \"Unknown_Female\", \"White_Female\", \"Asian_Female\", \"Black_Female\"]).range([\"#67001f\", \"#b2182b\", \"#ef8a62\", \"#fddbc7\", \"#ffffff\", \"#e0e0e0\", \"#bababa\", \"#4d4d4d\", \"#1a1a1a\"]); // Highlight the specie that is hovered\n\n        const highlight = function (event, d) {\n          console.log(d);\n          const selected_specie = d.race_sex;\n          tooltip.style(\"opacity\", 1);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", \"lightgrey\").attr(\"r\", 3);\n          d3.selectAll(\".\" + selected_specie).transition().duration(200).style(\"fill\", color(selected_specie)).attr(\"r\", 5);\n        }; // Highlight the specie that is hovered\n\n\n        const doNotHighlight = function (event, d) {\n          console.log(d);\n          tooltip.transition().duration(200).style(\"opacity\", 0);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", d => color(d.race_sex)).attr(\"r\", 3);\n        };\n\n        const mousemove = function (event, d) {\n          console.log(d);\n          tooltip.html(`The race and gender of the shooter is ${d.race_sex}, aged ${d.age}, causing ${d.kill_injure} injuries or deathes. `).style(\"left\", event.x / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n          .style(\"top\", event.y / 2 + \"px\");\n        };\n\n        svg.append('g').selectAll(\"dot\").data(data).enter().append(\"circle\").attr(\"class\", function (d) {\n          console.log(`HIHI${d.race_sex}`);\n          return \"dot \" + d.race_sex;\n        }).attr(\"cx\", function (d) {\n          console.log(d.age);\n          return x(d.age);\n        }).attr(\"cy\", function (d) {\n          console.log(d.kill_injure);\n          return y(d.kill_injure);\n        }).attr(\"r\", 3).style(\"fill\", function (d) {\n          return color(d.race_sex);\n        }).on(\"mouseover\", highlight).on(\"mouseleave\", doNotHighlight).on(\"mousemove\", mousemove);\n        svg.append('g');\n      });\n    })();\n  }, [ref]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"down-chart-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chart-title\",\n      children: \"PROFILE of SHOOTERS\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart usProfile\",\n      ref: ref\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"down-chart-example\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"./media/profile.svg\",\n        width: \"95%\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 41\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 11\n  }, this) //渲染了这个东西出来\n  ;\n}\n\n_s(Profile, \"6lPwhkhbwAf/KMa22COnjFPL+Eg=\");\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/charts/Profile.js"],"names":["React","useState","useEffect","d3","Profile","data","statesData","setStatesData","ref","useRef","formatter","format","margin","top","right","bottom","left","width","current","clientWidth","height","svg","select","append","attr","tooltip","style","csv","then","x","scaleLinear","domain","range","call","axisBottom","y","axisLeft","color","scaleOrdinal","highlight","event","d","console","log","selected_specie","race_sex","selectAll","transition","duration","doNotHighlight","mousemove","html","age","kill_injure","enter","on"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport * as d3 from \"d3\"\r\n\r\nfunction Profile(data) {\r\n\r\n  // const ref = React.useRef();\r\n  const [statesData, setStatesData] = useState([]);     //react用来注释数据\r\n  const ref = React.useRef(null)\r\n  // console.log(data)\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      // set the dimensions and margins of the graph\r\n\r\n      const formatter = d3.format(\".0%\");\r\n\r\n      const margin = { top: 10, right: 30, bottom: 30, left: 60 },\r\n        width = ref.current.clientWidth-30,\r\n        height = 400 - margin.top - margin.bottom;\r\n\r\n      // append the svg object to the body of the page\r\n      const svg = d3.select(\".usProfile\")\r\n        .append(\"svg\")\r\n        .attr(\"width\", width + margin.left + margin.right)\r\n        .attr(\"height\", height + margin.top + margin.bottom)\r\n        .append(\"g\")\r\n        .attr(\"transform\",\r\n          `translate(${margin.left}, ${margin.top})`);\r\n\r\n      const tooltip = d3.select(\".usProfile\")\r\n        .append(\"div\")\r\n        .style(\"opacity\", 0)\r\n        .attr(\"class\", \"tooltip\")\r\n        .style(\"background-color\", \"white\")\r\n        .style(\"border\", \"solid\")\r\n        .style(\"border-width\", \"1px\")\r\n        .style(\"border-radius\", \"5px\")\r\n        .style(\"padding\", \"10px\")\r\n\r\n      //Read the data\r\n      d3.csv(\"./data/profile.csv\").then(function (data) {\r\n        // Add X axis\r\n        const x = d3.scaleLinear()\r\n          .domain([10, 70])\r\n          .range([0, width]);\r\n        svg.append(\"g\")\r\n          .attr(\"transform\", `translate(0, ${height})`)\r\n          .call(d3.axisBottom(x));\r\n\r\n        // Add Y axis\r\n        const y = d3.scaleLinear()\r\n          .domain([0, 110])\r\n          .range([height, 0]);\r\n        svg.append(\"g\")\r\n          .call(d3.axisLeft(y));\r\n\r\n        // Color scale: give me a specie name, I return a color\r\n        const color = d3.scaleOrdinal()\r\n          .domain([\"Black_Male\", \"Asian_Male\", \"White_Male\", \"Unknown_Male\", \"Unknown\", \"Unknown_Female\", \"White_Female\", \"Asian_Female\", \"Black_Female\"])\r\n          .range([\"#67001f\", \"#b2182b\", \"#ef8a62\", \"#fddbc7\", \"#ffffff\", \"#e0e0e0\", \"#bababa\", \"#4d4d4d\", \"#1a1a1a\"])\r\n\r\n        // Highlight the specie that is hovered\r\n        const highlight = function (event, d) {\r\n          console.log(d)\r\n          const selected_specie = d.race_sex\r\n\r\n          tooltip\r\n            .style(\"opacity\", 1)\r\n\r\n          d3.selectAll(\".dot\")\r\n            .transition()\r\n            .duration(200)\r\n            .style(\"fill\", \"lightgrey\")\r\n            .attr(\"r\", 3)\r\n\r\n          d3.selectAll(\".\" + selected_specie)\r\n            .transition()\r\n            .duration(200)\r\n            .style(\"fill\", color(selected_specie))\r\n            .attr(\"r\", 5)\r\n        }\r\n\r\n        // Highlight the specie that is hovered\r\n        const doNotHighlight = function (event, d) {\r\n          console.log(d)\r\n          tooltip\r\n            .transition()\r\n            .duration(200)\r\n            .style(\"opacity\", 0)\r\n\r\n          d3.selectAll(\".dot\")\r\n            .transition()\r\n            .duration(200)\r\n            .style(\"fill\", d => color(d.race_sex))\r\n            .attr(\"r\", 3)\r\n        }\r\n\r\n        const mousemove = function (event, d) {\r\n          console.log(d)\r\n          tooltip\r\n            .html(`The race and gender of the shooter is ${d.race_sex}, aged ${d.age}, causing ${d.kill_injure} injuries or deathes. `)\r\n            .style(\"left\", (event.x) / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\r\n            .style(\"top\", (event.y) / 2 + \"px\")\r\n        }\r\n\r\n        svg.append('g')\r\n          .selectAll(\"dot\")\r\n          .data(data)\r\n          .enter()\r\n          .append(\"circle\")\r\n          .attr(\"class\", function (d) { console.log(`HIHI${d.race_sex}`); return \"dot \" + d.race_sex })\r\n          .attr(\"cx\", function (d) { console.log(d.age); return x(d.age); })\r\n          .attr(\"cy\", function (d) { console.log(d.kill_injure); return y(d.kill_injure); })\r\n          .attr(\"r\", 3)\r\n          .style(\"fill\", function (d) { return color(d.race_sex); })\r\n          .on(\"mouseover\", highlight)\r\n          .on(\"mouseleave\", doNotHighlight)\r\n          .on(\"mousemove\", mousemove)\r\n          svg.append('g')\r\n      })\r\n    })();\r\n  }, [ref]\r\n  )\r\n\r\n  return (<div className=\"down-chart-container\">\r\n  <div className=\"chart-title\">PROFILE of SHOOTERS</div>\r\n    <div className=\"down-chart usProfile\" ref={ref}></div> \r\n    <div className=\"down-chart-example\"><img src=\"./media/profile.svg\" width=\"95%\"/> </div>\r\n    </div>     //渲染了这个东西出来\r\n  )\r\n}\r\n\r\nexport default Profile"]},"metadata":{},"sourceType":"module"}