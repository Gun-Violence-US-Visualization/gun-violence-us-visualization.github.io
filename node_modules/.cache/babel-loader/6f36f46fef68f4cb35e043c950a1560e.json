{"ast":null,"code":"var _jsxFileName = \"/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/Correlation.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport * as d3 from \"d3\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Correlation(data) {\n  _s();\n\n  const [statesData, setStatesData] = useState([]); //react用来注释数据\n\n  const ref = React.useRef(null); // console.log(data)\n\n  useEffect(() => {\n    (async () => {\n      // set the dimensions and margins of the graph\n      const margin = {\n        top: 10,\n        right: 30,\n        bottom: 30,\n        left: 60\n      },\n            width = 560 - margin.left - margin.right,\n            height = 500 - margin.top - margin.bottom; // append the svg object to the body of the page\n\n      const svg = d3.select(\".usCorrelation\").append(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", `translate(${margin.left}, ${margin.top})`);\n      const tooltip = d3.select(\".usCorrelation\").append(\"div\").style(\"opacity\", 0).attr(\"class\", \"tooltip\").style(\"background-color\", \"white\").style(\"border\", \"solid\").style(\"border-width\", \"1px\").style(\"border-radius\", \"5px\").style(\"padding\", \"10px\"); //Read the data\n\n      d3.csv(\"state.csv\").then(function (data) {\n        // Add X axis\n        const x = d3.scaleLinear().domain([0, 110]).range([0, width]);\n        svg.append(\"g\").attr(\"transform\", `translate(0, ${height})`).call(d3.axisBottom(x)); // Add Y axis\n\n        const y = d3.scaleLinear().domain([0, 0.7]).range([height, 0]);\n        svg.append(\"g\").call(d3.axisLeft(y)); // Color scale: give me a specie name, I return a color\n\n        const color = d3.scaleLinear().domain([-25, 20]).range([\"red\", \"blue\"]); // Highlight the specie that is hovered\n\n        const highlight = function (event, d) {\n          const selected_specie = d.rate;\n          tooltip.style(\"opacity\", 1);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", \"lightgrey\").attr(\"r\", 3);\n          d3.selectAll(\"#\" + \"dot\" + d.state).transition().duration(200).style(\"fill\", color(selected_specie)).attr(\"r\", 5);\n        }; // Highlight the specie that is hovered\n\n\n        const doNotHighlight = function (event, d) {\n          tooltip.transition().duration(200).style(\"opacity\", 0);\n          d3.selectAll(\".dot\").transition().duration(200).style(\"fill\", d => color(d.rate)).attr(\"r\", 3);\n        };\n\n        const mousemove = function (event, d) {\n          tooltip.html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`).style(\"left\", event.x / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\n          .style(\"top\", event.y / 2 + \"px\");\n        };\n\n        svg.append('g').selectAll(\"dot\").data(data).enter().append(\"circle\").attr(\"class\", function (d) {\n          return \"dot \" + d.rate;\n        }).attr(\"id\", function (d) {\n          console.log(d.state);\n          return \"dot\" + d.state;\n        }).attr(\"cx\", function (d) {\n          return x(106 - d.policy);\n        }).attr(\"cy\", function (d) {\n          return y(d.gunhold);\n        }).attr(\"r\", 3).style(\"fill\", function (d) {\n          return color(d.rate);\n        }).on(\"mouseover\", highlight).on(\"mouseleave\", doNotHighlight).on(\"mousemove\", mousemove);\n        svg.append('g');\n      });\n    })();\n  }, [statesData.length]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    viewBox: \"0 0 960 600\",\n    className: \"usCorrelation\",\n    ref: ref\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 116,\n    columnNumber: 9\n  }, this) //渲染了这个东西出来\n  ;\n}\n\n_s(Correlation, \"6lPwhkhbwAf/KMa22COnjFPL+Eg=\");\n\n_c = Correlation;\nexport default Correlation;\n\nvar _c;\n\n$RefreshReg$(_c, \"Correlation\");","map":{"version":3,"sources":["/Users/lion/Sites/Visualization/project-on-github/Gun_Violence_US_Visualization/src/Correlation.js"],"names":["React","useState","useEffect","d3","Correlation","data","statesData","setStatesData","ref","useRef","margin","top","right","bottom","left","width","height","svg","select","append","attr","tooltip","style","csv","then","x","scaleLinear","domain","range","call","axisBottom","y","axisLeft","color","highlight","event","d","selected_specie","rate","selectAll","transition","duration","state","doNotHighlight","mousemove","html","gunhold","policy","enter","console","log","on","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport * as d3 from \"d3\"\r\n\r\nfunction Correlation(data) {\r\n    const [statesData, setStatesData] = useState([]);     //react用来注释数据\r\n    const ref = React.useRef(null)\r\n    // console.log(data)\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            // set the dimensions and margins of the graph\r\n            const margin = { top: 10, right: 30, bottom: 30, left: 60 },\r\n                width = 560 - margin.left - margin.right,\r\n                height = 500 - margin.top - margin.bottom;\r\n\r\n            // append the svg object to the body of the page\r\n            const svg = d3.select(\".usCorrelation\")\r\n                .append(\"svg\")\r\n                .attr(\"width\", width + margin.left + margin.right)\r\n                .attr(\"height\", height + margin.top + margin.bottom)\r\n                .append(\"g\")\r\n                .attr(\"transform\",\r\n                    `translate(${margin.left}, ${margin.top})`);\r\n\r\n            const tooltip = d3.select(\".usCorrelation\")\r\n                .append(\"div\")\r\n                .style(\"opacity\", 0)\r\n                .attr(\"class\", \"tooltip\")\r\n                .style(\"background-color\", \"white\")\r\n                .style(\"border\", \"solid\")\r\n                .style(\"border-width\", \"1px\")\r\n                .style(\"border-radius\", \"5px\")\r\n                .style(\"padding\", \"10px\")\r\n\r\n            //Read the data\r\n            d3.csv(\"state.csv\").then(function (data) {\r\n                // Add X axis\r\n                const x = d3.scaleLinear()\r\n                    .domain([0, 110])\r\n                    .range([0, width]);\r\n                svg.append(\"g\")\r\n                    .attr(\"transform\", `translate(0, ${height})`)\r\n                    .call(d3.axisBottom(x));\r\n\r\n                // Add Y axis\r\n                const y = d3.scaleLinear()\r\n                    .domain([0, 0.7])\r\n                    .range([height, 0]);\r\n                svg.append(\"g\")\r\n                    .call(d3.axisLeft(y));\r\n\r\n                // Color scale: give me a specie name, I return a color\r\n                const color = d3.scaleLinear().domain([-25,20])\r\n                    .range([\"red\", \"blue\"])\r\n\r\n                // Highlight the specie that is hovered\r\n                const highlight = function (event, d) {\r\n                    const selected_specie = d.rate\r\n\r\n                    tooltip\r\n                        .style(\"opacity\", 1)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", \"lightgrey\")\r\n                        .attr(\"r\", 3)\r\n\r\n                    d3.selectAll(\"#\" + \"dot\" + d.state)\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", color(selected_specie))\r\n                        .attr(\"r\", 5)\r\n                }\r\n\r\n                // Highlight the specie that is hovered\r\n                const doNotHighlight = function (event, d) {\r\n                    tooltip\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"opacity\", 0)\r\n\r\n                    d3.selectAll(\".dot\")\r\n                        .transition()\r\n                        .duration(200)\r\n                        .style(\"fill\", d => color(d.rate))\r\n                        .attr(\"r\", 3)\r\n                }\r\n                const mousemove = function (event, d) {\r\n                    tooltip\r\n                        .html(`${d.state}: with a gun possessing rate of ${d.gunhold} and ${106 - d.policy} qualifications on gun holding`)\r\n                        .style(\"left\", (event.x) / 2 + \"px\") // It is important to put the +90: other wise the tooltip is exactly where the point is an it creates a weird effect\r\n                        .style(\"top\", (event.y) / 2 + \"px\")\r\n                }\r\n                svg.append('g')\r\n                    .selectAll(\"dot\")\r\n                    .data(data)\r\n                    .enter()\r\n                    .append(\"circle\")\r\n                    .attr(\"class\", function (d) {  return \"dot \" + d.rate })\r\n                    .attr(\"id\", function (d) { console.log(d.state);  return \"dot\" + d.state })\r\n                    .attr(\"cx\", function (d) {  return x(106 - d.policy); })\r\n                    .attr(\"cy\", function (d) { return y(d.gunhold); })\r\n                    .attr(\"r\", 3)\r\n                    .style(\"fill\", function (d) { return color(d.rate); })\r\n                    .on(\"mouseover\", highlight)\r\n                    .on(\"mouseleave\", doNotHighlight)\r\n                    .on(\"mousemove\", mousemove)\r\n                svg.append('g')\r\n            })\r\n        })();\r\n    }, [statesData.length]\r\n    )\r\n\r\n    return (\r\n        <div viewBox=\"0 0 960 600\" className=\"usCorrelation\" ref={ref}></div>      //渲染了这个东西出来\r\n    )\r\n}\r\n\r\nexport default Correlation"]},"metadata":{},"sourceType":"module"}